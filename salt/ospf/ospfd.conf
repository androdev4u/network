{%- set id = salt['grains.get']('id') %}
{%- set core_ifaces = ['br-core', 'core'] %}

{%- for iface in core_ifaces %}
interface {{ iface }}
    ip ospf network multicast
    ip ospf authentication message-digest
    ip ospf authentication-key secret

{%- endfor %}

router ospf
    router-id {{ pillar['hosts-inet']['core'][id] }}
    
    passive-interface default
{%- for iface in core_ifaces %}
    no passive-interface {{ iface }}
{%- endfor %}

    network {{ pillar['subnets-inet']['core'] }} area 0
    area 0 authentication message-digest
    redistribute connected
